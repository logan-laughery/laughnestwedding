<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">

<dom-module id="side-menu">
    <template>
    <style>
    	.large {
    	  transform: scale(2) translateX(1px);
	  transform-origin: right;
    	}
	.large[data-direction$="left"]{
	  transform: scale(2) translateX(-1px);
	  transform-origin: left;
	}
	.menu-item {
          font-family: 'Oswald', sans-serif;
	  text-align: right;
      	}
	.menu-item[data-direction$="left"]{
	  text-align: left;
	}
	.wrapper {
	  height: 40px;
	  //width: 80px;
	  //text-align: left;
	}
	#menu {
	  height: 100px;
	  transition: .5s;
	  transition-delay: .5s;
	}
    </style>

    <div id="menu" class="{{direction}}">
	    <div class="wrapper">
       <div id="what" data-direction$="[[direction]]" on-click="whatClick" class$="menu-item {{getClass('what',targetItem,loading)}}">
        what
       </div></div>
       <div class="wrapper">
      <div id="when" data-direction$="[[direction]]" on-click="whereClick" class$="menu-item {{getClass('where',targetItem,loading)}}">
        when
      </div></div>
    </div>
  </template>
    <script>
        Polymer({
            is: 'side-menu',
            behaviors: [
                Polymer.NeonAnimationRunnerBehavior
            ],
            listeners: {
                'neon-animation-finish': '_onNeonAnimationFinish'
            },
            getClass: function(name, target, loading) {
                if (name == target && !loading) {
                    return 'large';
                }
                return '';
            },
            properties: {
		direction: {
		    type: String,
		    value: 'left'
		},
                position: {
                    type: Number,
                    value: 0
                },
                targetItem: {
                    type: String,
                    value: 'what'
                },
                loading: {
                    type: Boolean,
                    value: false
                },
                animationConfig: {
                    value: function() {
                        var menuContainer = Polymer.dom(this.root).querySelector('#menu');
                        var whatContainer = Polymer.dom(this.root).querySelector('#what');
                        var whenContainer = Polymer.dom(this.root).querySelector('#when');
                        return {
                            'where': [{
                                name: 'transform-animation',
                                node: whenContainer,
				transformTo: 'scale(2) translateX(1px)',
				transformOrigin: 'right',
				timing: {
				    delay: 1000,
				    duration: 500
				}
                            }],
                            'where-left': [{
                                name: 'transform-animation',
                                node: whenContainer,
				transformTo: 'scale(2) translateX(-1px)',
				transformOrigin: 'left',
				timing: {
				    delay: 1000,
				    duration: 500
				}
			    }],
                            'what': [{
                                name: 'transform-animation',
                                node: whatContainer,
				transformTo: 'scale(2) translateX(1px)',
				transformOrigin: 'right',
				timing: {
				    delay: 1000,
				    duration: 500
				}
                            }],
                            'what-left': [{
                                name: 'transform-animation',
                                node: whatContainer,
				transformTo: 'scale(2) translateX(-1px)',
				transformOrigin: 'left',
				timing: {
				    delay: 1000,
				    duration: 500
				}
			    }],
			    'exit-where': [{
			    	name: 'transform-animation',
				node: whenContainer,
				transformTo: 'scale(1)',
				transformFrom: 'scale(2) translateX(1px)',
				transformOrigin: 'right',
				timing: {
				    duration: 500
				}
			    }],
			    'exit-where-left': [{
			    	name: 'transform-animation',
				node: whenContainer,
				transformTo: 'scale(1)',
				transformFrom: 'scale(2) translateX(-1px)',
				transformOrigin: 'left',
				timing: {
				    duration: 500
				}
			    }],
			    'exit-what': [{
			    	name: 'transform-animation',
				node: whatContainer,
				transformTo: 'scale(1)',
				transformFrom: 'scale(2) translateX(1px)',
				transformOrigin: 'right',
				timing: {
				    duration: 500
				}
			    }],
			    'exit-what-left': [{
			    	name: 'transform-animation',
				node: whatContainer,
				transformTo: 'scale(1)',
				transformFrom: 'scale(2) translateX(-1px)',
				transformOrigin: 'left',
				timing: {
				    duration: 500
				}
			    }]
                        }
                    }
                }
            },
            listeners: {
                'neon-animation-finish': '_onNeonAnimationFinish'
            },
            getClass: function(name, target, loading) {
                if (name == target && !loading) {
                    return 'large';
                }
                return '';
            },
            what: function() {
		if(this.direction == 'left')
			this.playAnimation('exit-where-left');
		else	
			this.playAnimation('exit-where');
		this.$.menu.style.transform = 'translateY(-50%)';		
                this.targetItem = 'what';
                this.loading = true;
                this.position = -50;
                if(this.direction == 'left')
		       this.playAnimation('what-left');
		else	
		       this.playAnimation('what');
            },
            whatClick: function() {
                this.fire('what');
            },
            where: function() {
		if(this.direction == 'left')
			this.playAnimation('exit-what-left');
		else
			this.playAnimation('exit-what');
		this.$.menu.style.transform = 'translateY(50%)';
                this.targetItem = 'where';
                this.loading = true;
                this.position = 50;
                if(this.direction == 'left')
			this.playAnimation('where-left');
	        else	
		 	this.playAnimation('where');
            },
            whereClick: function() {
                this.fire('where');
            },
            _onNeonAnimationFinish: function() {
		if (this.loading) {
                this.loading = false;
                var menu = Polymer.dom(this.root).querySelector('#menu');
                //menu.style.transform = 'translateY(' + this.position + '%)';
		}
            }
        });
    </script>
</dom-module>
